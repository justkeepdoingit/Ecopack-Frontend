<form [formGroup]="packingGroup" (ngSubmit)="saveData(packingGroup.value)">
    <h3 mat-dialog-title>For Delivery</h3>
    <mat-dialog-content>
        <div class="justify grid md:grid-cols-5 gap-2">
            <div class="flex flex-col md:flex-row md:max-w-full gap-2">
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Date Needed</mat-label>
                        <input formControlName="date" [min]='minDate' matInput [matDatepicker]="picker">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker touchUi #picker color="accent"></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Truck</mat-label>
                        <mat-select formControlName="truck">
                            <div class=" text-center w-full">
                                <mat-form-field appearance="outline">
                                    <mat-label>Search</mat-label>
                                    <input (keyup)="filterTrucks($event)" matInput placeholder="Search" #input>
                                </mat-form-field>
                            </div>
                            <mat-option (click)="truckSelect(truck.value)"
                                *ngFor="let truck of (!searching ? trucks : filteredTrucks)" [value]="truck.value">
                                {{truck.viewValue}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Capacity</mat-label>
                        <input readonly formControlName="capacity" matInput placeholder="Search" readonly #input>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Total</mat-label>
                        <input readonly formControlName="total" matInput placeholder="Search" readonly #input>
                    </mat-form-field>
                </div>
                <div class="flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Percent Full</mat-label>
                        <input readonly formControlName="percent" matInput placeholder="Search" readonly #input>
                        <mat-icon matSuffix [ngClass]="styles">percent</mat-icon>
                    </mat-form-field>
                </div>
            </div>
        </div>
        <div class=" overflow-y-auto relative">
            <div id="tables" class=" relative overflow-auto">
                <mat-table formArrayName="infodata" matRipple [matRippleUnbounded]="unbounded"
                    [matRippleCentered]="centered" [matRippleRadius]="radius"
                    class=" text-secondary-700 font-medium cursor-pointer" #table matSort [dataSource]="newDataSource">
                    <ng-container matColumnDef="date">
                        <mat-header-cell class="dates" *matHeaderCellDef> Date
                        </mat-header-cell>
                        <mat-cell class="dates" *matCellDef="let element">
                            {{datepipe.transform(element.date, 'yyyy-MM-dd')}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="so">
                        <mat-header-cell class="so" *matHeaderCellDef> SO#
                        </mat-header-cell>
                        <mat-cell class="so" class="so" *matCellDef="let element">
                            {{element.so}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="po">
                        <mat-header-cell class="po" *matHeaderCellDef> PO#
                        </mat-header-cell>
                        <mat-cell class="po" *matCellDef="let element">
                            {{element.po}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="name">
                        <mat-header-cell class="names" *matHeaderCellDef> Name
                        </mat-header-cell>
                        <mat-cell class="names" *matCellDef="let element">
                            {{element.name}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="item">
                        <mat-header-cell class="items" *matHeaderCellDef> Item
                        </mat-header-cell>
                        <mat-cell class="items" *matCellDef="let element">
                            {{element.item}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="itemdesc">
                        <mat-header-cell class="itemdesc" *matHeaderCellDef> Item Desc
                        </mat-header-cell>
                        <mat-cell class="itemdesc" *matCellDef="let element">
                            {{element.itemdesc}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="qty">
                        <mat-header-cell *matHeaderCellDef> Order Qty </mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{element.qty}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="qtydeliver">
                        <mat-header-cell *matHeaderCellDef>Estimated Qty</mat-header-cell>
                        <mat-cell [formGroupName]="i" *matCellDef="let element; let i = index">
                            <mat-form-field class=" text-center" appearance="outline">
                                <mat-label>Entery Qty</mat-label>
                                <input (keyup)="updateTotal($event, element)" formControlName="qtydeliver" matInput
                                    placeholder="Enter Delivery Value" #pending>
                            </mat-form-field>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="volume">
                        <mat-header-cell *matHeaderCellDef>Volume</mat-header-cell>
                        <mat-cell *matCellDef="let element"> {{(element.volume)}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="volumet">
                        <mat-header-cell *matHeaderCellDef>Total Volume
                        </mat-header-cell>
                        <mat-cell *matCellDef="let element; let i = index">
                            {{(getValue(i)*element.volume).toLocaleString()}}
                        </mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                </mat-table>
            </div>
        </div>
        <!-- <mat-paginator [pageSize]="5" [pageSizeOptions]="[ 5, 10, 25, 100]" aria-label="Select page">
        </mat-paginator> -->
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-stroked-button [disabled]="packingGroup.invalid" color="primary">Save</button>
        <button mat-stroked-button [mat-dialog-close] color="warn">Cancel</button>
    </mat-dialog-actions>
</form>