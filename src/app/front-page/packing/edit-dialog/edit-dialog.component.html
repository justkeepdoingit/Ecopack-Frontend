<form [formGroup]="packingGroup" (ngSubmit)="editData(packingGroup.value)">
    <h3 mat-dialog-title>For Delivery Edit</h3>
    <mat-dialog-content>
        <div class="justify grid md:grid-cols-5 gap-2">
            <div class="flex flex-col md:flex-row md:max-w-full gap-2">
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Date Needed</mat-label>
                        <input formControlName="date" [min]='minDate' matInput [matDatepicker]="picker">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker touchUi #picker color="accent"></mat-datepicker>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Truck</mat-label>
                        <mat-select formControlName="truck">
                            <div class=" text-center w-full">
                                <mat-form-field appearance="outline">
                                    <mat-label>Search</mat-label>
                                    <input (keyup)="filterTrucks($event)" matInput placeholder="Search" #input>
                                </mat-form-field>
                            </div>
                            <mat-option (click)="truckSelect(truck.value)"
                                *ngFor="let truck of (!searching ? trucks : filteredTrucks)" [value]="truck.value">
                                {{truck.viewValue}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Capacity</mat-label>
                        <input readonly formControlName="capacity" matInput placeholder="Search" readonly #input>
                    </mat-form-field>
                </div>
                <div class=" flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Total</mat-label>
                        <input readonly formControlName="total" matInput placeholder="Search" readonly #input>
                    </mat-form-field>
                </div>
                <div class="flex flex-col justify-start w-full">
                    <mat-form-field appearance="outline">
                        <mat-label>Percent Full</mat-label>
                        <input readonly formControlName="percent" matInput placeholder="Search" readonly #input>
                        <mat-icon matSuffix [ngClass]="styles">percent</mat-icon>
                    </mat-form-field>
                </div>
            </div>
        </div>
        <div class=" overflow-y-auto relative">
            <div id="tables" class=" relative overflow-auto">
                <mat-table formArrayName="infodata" matRipple [matRippleUnbounded]="unbounded"
                    [matRippleCentered]="centered" [matRippleRadius]="radius"
                    class=" text-secondary-700 font-medium cursor-pointer" #table matSort [dataSource]="newDataSource">
                    <ng-container matColumnDef="date">
                        <mat-header-cell class="dates text-primary-900" *matHeaderCellDef> Date
                        </mat-header-cell>
                        <mat-cell class="dates text-primary-900" *matCellDef="let element">
                            {{datepipe.transform(element.date, 'yyyy-MM-dd')}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="po">
                        <mat-header-cell class="po text-secondary-900" *matHeaderCellDef> PO#
                        </mat-header-cell>
                        <mat-cell class="po text-secondary-900" *matCellDef="let element">
                            {{element.po}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="name">
                        <mat-header-cell class="names text-primary-900" *matHeaderCellDef> Name
                        </mat-header-cell>
                        <mat-cell class="names text-primary-900" *matCellDef="let element">
                            {{element.name}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="item">
                        <mat-header-cell class="items text-secondary-900" *matHeaderCellDef> Item
                        </mat-header-cell>
                        <mat-cell class="items text-secondary-900" *matCellDef="let element">
                            {{element.item}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="itemdesc">
                        <mat-header-cell class="itemdesc text-primary-900" *matHeaderCellDef> Item Desc
                        </mat-header-cell>
                        <mat-cell class="itemdesc text-primary-900" *matCellDef="let element">
                            {{element.itemdesc}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="qty">
                        <mat-header-cell class="text-secondary-900" *matHeaderCellDef> Order Qty </mat-header-cell>
                        <mat-cell class="text-secondary-900" *matCellDef="let element"> {{element.qty}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="qtydeliver">
                        <mat-header-cell class=" text-primary-900" *matHeaderCellDef>Estimated Qty</mat-header-cell>
                        <mat-cell [formGroupName]="i" *matCellDef="let element; let i = index">
                            <mat-form-field class=" text-center" appearance="outline">
                                <mat-label>Entery Qty</mat-label>
                                <input (keyup)="updateTotal($event, element)" formControlName="qtydeliver" matInput
                                    placeholder="Enter Delivery Value" #pending>
                            </mat-form-field>
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="volume">
                        <mat-header-cell class="text-secondary-900" *matHeaderCellDef>Volume</mat-header-cell>
                        <mat-cell class="text-secondary-900" *matCellDef="let element"> {{(element.volume)}}
                        </mat-cell>
                    </ng-container>

                    <ng-container matColumnDef="volumet">
                        <mat-header-cell class="text-primary-900" *matHeaderCellDef>Total Volume
                        </mat-header-cell>
                        <mat-cell class="text-primary-900" *matCellDef="let element; let i = index">
                            <span *ngIf="!deleting">
                                {{(getValue(i)*element.volume).toLocaleString()}}
                            </span>
                            <span *ngIf="deleting">
                                <button type="button" (click)="deletePld(element)" mat-stroked-button
                                    color="warn">Delete</button>
                            </span>
                        </mat-cell>
                    </ng-container>

                    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
                    <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                </mat-table>
            </div>
        </div>
        <!-- <mat-paginator [pageSize]="5" [pageSizeOptions]="[ 5, 10, 25, 100]" aria-label="Select page">
        </mat-paginator> -->
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <button mat-raised-button type="button" (click)="addList(packingGroup.value)" color="primary">Add</button>
        <button mat-raised-button (click)="deleting ? deleting=false: deleting=true" type="button"
            color="warn">Delete</button>
        <button mat-stroked-button [disabled]="packingGroup.invalid" color="primary">Save</button>
        <button mat-stroked-button [mat-dialog-close] color="warn">Close</button>
    </mat-dialog-actions>
</form>